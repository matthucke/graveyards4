//
// COUNTIES / SHOW - show graveyards in a county
//
//      @county County
//      @graveyards Array
//
// view: /counties/show.html.haml 
// urls:
//      /Illinois/Cook
//      /Missouri/St_Louis_City etc
//
:ruby
    county_name = @county.fancy_name_with_state

= render :partial => "counties/county_header", :locals => { :overhead => 'Cemeteries and Graveyards in'}


/ THE COLUMNS.
/ This doesn't use bootstrap, but rather html5 columns, with the number dynamically
/ chosen according to math involving screen width, column and gutter width.
.column-container
    .column-set
        - if current_user
            .cell#symbol-key
                .cell-bottom
                    %ul.symbol-key
                        %li.visited
                            %span.glyphicon.glyphicon-flag
                            you've visited
                        %li.not-visited
                            %span.glyphicon.glyphicon-flag
                            not visited

        - @graveyards.each do |g|
            - pic = g.main_photo
            - visit = @visits.visit_for(g)
            - klasses = [ 'cell', pic ? 'with-pix' : 'no-pix' ]
            - klasses.push(visit ? 'visited' : 'not-visited') if current_user
            %div{class: klasses, data: { location_id: g.id }, id: "g#{g.id}" }
                - if pic
                    .cell-top
                        .thumbnail-box
                            %a{:href=>g.to_url }
                                %img{:src=> pic.thumbnail_path, :alt=>"#{g.name} in #{county_name}" }
                .cell-bottom
                    .cell-main
                        %a{:href=>g.to_url}=g.name
                    - if !pic
                        .no-pix-msg
                            photos not available
                    .cell-tools
                        - if current_user
                            // later use glyphicon-pushpin to add to one's to-do list
                            - if visit
                                %a.visit-details{href: '#', title: "You visited this location #{visit.visited_at}"}
                                    %span.glyphicon.glyphicon-flag
                            - else
                                %a.visit-details{href: '#', title: "Not visited - click to add to your list."}
                                    %span.glyphicon.glyphicon-flag
        .clear
    .clear

