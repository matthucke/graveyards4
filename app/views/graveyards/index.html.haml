:ruby
    columns = [ @states ]
    if @main_state
        columns = [ [@main_state], @states.to_a - [ @main_state ] ].reject(&:empty?)
    end

- if @main_state
    .container
        .row
            .col-md-6
                %p
                    This site focuses on the
                    %strong="Graveyards of #{@main_state.name},"
                    and we strive for complete listings of
                    cemeteries in
                    ="#{@main_state.name}."

            .col-md-6
                %p
                    Other states and countries are listed below,
                    only to show the graveyards that the site owner
                    has personally visited.  Listings outside of
                    %strong="#{@main_state.name}"
                    are
                    %i not
                    intended to be complete.


.container
    .row
        - columns.each do |state_list|
            .col-md-6
                - state_list.each do |state|
                    %h1=state.name

                    %ul.cemetery-list
                        - state.counties.sort_by(&:name).each do |c|
                            %li
                                %a{href: c.to_url, :title=>"#{c.fancy_name_with_state} Cemetery List and Photos"}
                                    = "#{c.fancy_name_with_state} Cemeteries"
                                =raw '&mdash;'
                                - if current_user && @visit_summary
                                    - if s = @visit_summary.get(c.id)
                                        - if s.visited.to_i > 0
                                            %span.flag-visits-visited
                                                %span.glyphicon.glyphicon-flag
                                                %strong=s.visited.to_i
                                        - else
                                            %span.flag-visits-none
                                                %span.glyphicon.glyphicon-flag
                                                %strong=0
                                        - if (todo=s.todo.to_i) > 0
                                            %span.flag-visits-todo
                                                %span.glyphicon.glyphicon-flag
                                                %strong=todo.to_i
                                    %em="/ #{c.graveyards_count}"
                                - else
                                    %em=c.graveyards_count